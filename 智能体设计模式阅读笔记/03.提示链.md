## 提示链(Prompt Chaining)

### 提示链模式概述

提示链主张,与其让llm一步到位解决复杂问题, 不如对复杂问题进行拆分, 分解为一系列更小,更容易解决的自问题, 再对每个子问题分配单独的处理器, 并构成链式调用, 让前一步的输出作为后一步的输入, 形成链式依赖. 这种方式可对每个细小问题进行精细化处理, 从而进一步提升准确性和针对性.

示例: 

1. 初始提示(摘要) : “请总结以下市场调研报告的主要发现:[文本]”。模型专注于摘要,准确性更高。
2. 第二步(趋势识别):“根据摘要,识别三大新兴趋势并提取支持数据点:[第 1 步输出]”。提示更聚焦,建立在已验证结果之上。
3. 第三步(邮件撰写):“请为市场团队撰写一封简明邮件,概述上述趋势及数据支持:[第 2 步输出]”。



### 上下文工程与提示工程

上下文工程是一种系统性方法, 该方法认为: 模型输出质量更多取决于所提供的丰富的上下文, 而非模型架构本身. 上下文工程是传统提示工程的升级, 后者仅优化用户即时问题的表达. 上下文工程扩展至多层信息, 包括系统提示与外部工具等. 

因此, 任务不再是简单答疑, 而是为智能体构建完整操作视图.

实际应用中,可用专门调优系统自动提升上下文质量,   一个在线直接“压缩/净化上下文”的开源库: **LLMLingua**



### 问题

根据讲解我们知道了提示链方法,  但智能体是如何根据用户的问题来决定回答方式的呢?是直接回答还是调用工具, 亦或者使用提示链.

答: 需要一个 **路由层**, 它的职责就是**先判断这句话该怎么处理**，再把任务交给对应的执行方式.

路由层可由**自定义规则**+**llm** 来实现,  路由后通常接三种执行器, 1. 直接回答. 2. 工具调用. 3. 多步规划, 这里多步规划就相当于上下文工程, 而该工程最稳定的实现方式即为langchain的LCEL这种形式, 即有人工提前规定好调用链, 来拆分解答问题.

