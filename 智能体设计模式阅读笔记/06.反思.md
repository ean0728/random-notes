## 反思

### 反思模式概述

反思模式指的是智能体对自身的工作、输出或内部状态进行评估,并利用评估结果来提升性能或优化响应。反思有时也可以由专门负责分析初始智能体输出的独立智能体来实现。

反思流程包括：

- 执行：智能体完成人物或生成初始输出。
- 评估/批判： Agent分析上一步结果， 检查事实准确性，连贯性，风格，完整性，是否遵循指令等。
- 反思/优化： 根据批判结果，智能体决定如何改进，可能生成优化后的输出，调整参数，甚至修改整体计划。
- 迭代：优化后的输出或调整后的方案再次执行，反思过程可重复，直到达到满意结果或满足终止条件。

“生成者 ‐ 批评者”或“生产者 ‐ 审阅者”模型， 通过两个专门智能体可获得更客观、更结构化的结果。

- 生产者智能体:负责任务的初步执行,专注于内容生成,如编写代码、撰写博客或制定计划。它根据初始提示生成第一版输出。
- 批评者智能体:专门评估生产者生成的输出,拥有不同的指令和角色设定(如“你是一名资深软件工程师”、“你是一名严谨的事实核查员”)。批评者根据特定标准(如事实准确性、代码质量、风格要求、完整性等)分析生产者的工作,发现问题、提出改进建议并给出结构化反馈

反思模式对于构建能够输出高质量结果、处理复杂任务、具备一定自我意识和适应性的智能体至关重要。它让智能体不仅仅是执行指令,更具备高级问题解决和内容生成能力。

---

### 应用场景

- 创意写作与内容生成
- 代码生成与调试
- 复杂问题求解
- 摘要与信息整合
- 规划与策略制定
- 对话智能体
  - 回顾对话历史,保持上下文、纠正误解或提升响应质量。

---

### 代码示例

---

### 关键要点

- 反思模式的核心优势是能迭代自我纠错和优化输出,显著提升质量、准确性和复杂指令的遵循度。
- 包含执行、评估/批判和优化的反馈循环,适用于高质量、准确或复杂输出任务。
- 但需权衡延迟和计算成本增加,以及模型上下文窗口溢出或 API 限流风险。
- 该模式让智能体具备自我纠错和持续性能提升能力。

---

### 总结

反思模式为智能体工作流提供了关键的自我纠错机制,实现了超越单次执行的迭代优化。其核心是建立一个循环:系统生成输出,按特定标准评估,再利用评估结果生成优化版本。

但需要注意,虽然反思模式显著提升输出质量,但也带来重要权衡。迭代过程每次优化都需新的 LLM 调用,导致成本和延迟增加,不适合对时效性要求高的场景。此外,该模式对内存消耗较大,每次迭代都会扩展对话历史,包括初始输出、批判和后续优化内容。
